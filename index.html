<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ukrainian Cyborgs</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script> <style>
        /* –°—Ç–∏–ª—ñ –∑ ClickGPT, –∞–¥–∞–ø—Ç–æ–≤–∞–Ω—ñ –ø—ñ–¥ –∫–æ–ª—å–æ—Ä–∏ –£–∫—Ä–∞—ó–Ω–∏ */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0d1b2a; /* –¢–µ–º–Ω–æ-—Å–∏–Ω—ñ–π, —è–∫ –Ω—ñ—á–Ω–µ –Ω–µ–±–æ –∞–±–æ –∫–∞–º—É—Ñ–ª—è–∂ */
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
            position: relative;
        }
        .background-animation {
            background: linear-gradient(45deg, #0d1b2a, #005a8d, #0d1b2a); /* –°–∏–Ω—ñ–π –≥—Ä–∞–¥—ñ—î–Ω—Ç */
            animation: gradientAnimation 15s ease infinite;
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background-size: 400% 400%;
            z-index: -1;
        }
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .container {
            background-color: #1b263b; /* –¢–µ–º–Ω–æ-—Å—ñ—Ä–∏–π/—Å–∏–Ω—ñ–π */
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(255, 200, 0, 0.5); /* –ñ–æ–≤—Ç–∏–π –≤—ñ–¥—Ç—ñ–Ω–æ–∫ */
            padding: 30px;
            text-align: center;
            width: 90%;
            max-width: 450px;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        h1 {
            color: #FFD700; /* –ó–æ–ª–æ—Ç–æ/–ñ–æ–≤—Ç–∏–π */
            margin-bottom: 20px;
            font-size: 2.2em;
            text-shadow: 0 0 10px rgba(255, 200, 0, 0.7);
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 25px;
            font-size: 1.1em;
            flex-wrap: wrap;
        }
        .stat-item {
            margin: 5px 10px;
        }
        .stat-value {
            color: #00BFFF; /* –ë–ª–∞–∫–∏—Ç–Ω–∏–π */
            font-weight: bold;
        }

        .main-button {
            background-color: #00BFFF; /* –ë–ª–∞–∫–∏—Ç–Ω–∏–π */
            color: #1a1a2e;
            border: none;
            border-radius: 50%;
            width: 180px;
            height: 180px;
            font-size: 2.5em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.8), 0 0 40px rgba(0, 191, 255, 0.5);
            margin-bottom: 25px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            background-image: url('https://via.placeholder.com/180/FFD700/0d1b2a?text=CYBORG'); /* –°—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω–∏–π –ö—ñ–±–æ—Ä–≥ */
            background-size: cover;
            background-position: center;
        }
        .main-button.clicked::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            animation: pulse 0.4s ease-out forwards;
        }
        @keyframes pulse {
            0% { width: 0; height: 0; opacity: 0.5; }
            100% { width: 200px; height: 200px; opacity: 0; }
        }
        .floating-text {
            position: absolute;
            color: #FFD700; /* –ñ–æ–≤—Ç–∏–π */
            font-size: 2em;
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
            text-shadow: 0 0 5px rgba(255, 200, 0, 0.8);
        }
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        /* ... (–°—Ç–∏–ª—ñ –¥–ª—è progress-bar, nav-buttons, modals, toast –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è —ñ—Å–Ω—É—é—á–∏–º–∏) ... */
        /* –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –∫–æ–ª—å–æ—Ä—ñ–≤ */
        .progress-bar-container { background-color: #3a3a60; }
        .progress-bar-fill { background-color: #FFD700; /* –ñ–æ–≤—Ç–∏–π */ }
        .nav-button.active {
            background-color: #FFD700;
            color: #0d1b2a;
            box-shadow: 0 0 15px rgba(255, 200, 0, 0.5);
        }
        .modal-content { background-color: #1b263b; box-shadow: 0 0 25px rgba(0, 191, 255, 0.6); }
        .modal-content h2 { color: #00BFFF; }
        .upgrade-info h3, .mission-info h3, .card-info h3, .chest-info h3, .presale-info h3, .store-info h3, .boost-info h3, .computer-part-info h3, .clan-info h3, .stats-info h3 {
            color: #FFD700;
        }
        .buy-button, .complete-button, .claim-button, .activate-button {
            background-color: #00BFFF;
            color: #0d1b2a;
        }
        .buy-button:hover, .complete-button:hover, .claim-button:hover, .activate-button:hover {
            background-color: #0099CC;
        }
        .toast-notification {
            background-color: rgba(0, 191, 255, 0.9);
            color: #0d1b2a;
        }
        .cost-display .icon.ton { 
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2300bfff"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 17c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7zm0-10h-2V7h2c1.1 0 2 .9 2 2s-.9 2-2 2zm-2 4h4v-2h-4c-1.1 0-2-.9-2-2s.9-2 2-2h2V7H8v2h2c1.1 0 2 .9 2 2s-.9 2-2 2zm6-4h-4v-2h4V7h2v2h-2v2h2v4h-2V13z"/></svg>') center/contain no-repeat; 
        }
        .cost-display .icon.ucbg { 
             /* –°–∏–º–≤–æ–ª UCBG - –¢—Ä–∏–∑—É–± */
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23FFD700"><path d="M12 2L10 6H4l4 4-2 4 6 2 6-2-2-4 4-4H14l-2-4z"/></svg>') center/contain no-repeat; 
        }
        .cost-display .icon.ton { fill: #00BFFF; }
        
        .language-selector {
            margin-top: 10px;
            display: flex;
            justify-content: center;
        }
        .language-selector button {
            background-color: #3a3a60;
            color: #e0e0e0;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            margin: 0 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .language-selector button.active {
            background-color: #00BFFF;
            color: #0d1b2a;
        }
    </style>
</head>
<body>
    <div class="background-animation"></div>
    <div class="container" id="gameContainer">
        <h1>üá∫üá¶ Ukrainian Cyborgs</h1>
        <div class="stats">
            <div class="stat-item">UCBG: <span id="ucbgCount" class="stat-value">0</span></div>
            <div class="stat-item">TON: <span id="tonCount" class="stat-value">0</span></div>
            <div class="stat-item">–ú–æ—â–Ω—ñ—Å—Ç—å (–ö–ª—ñ–∫): <span id="clickPower" class="stat-value">1</span></div>
            <div class="stat-item">–ê–≤—Ç–æ-–¥–æ—Ö—ñ–¥: <span id="autoClickPowerDisplay" class="stat-value">0</span></div>
        </div>
        <button class="main-button" id="mainButton"></button>
        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="worldProgressFill"></div>
        </div>
        <div class="progress-text">–ï–º—ñ—Å—ñ—è UCBG: <span id="worldProgressText">0%</span></div>

        <div class="language-selector">
            <button id="langUA" class="active">UA</button>
            <button id="langEN">EN</button>
            <button id="langRU">RU</button>
        </div>

        <div class="nav-buttons">
            <button class="nav-button active" id="btnHome">–ì–æ–ª–æ–≤–Ω–∞</button>
            <button class="nav-button" id="btnUpgrades">–ü—Ä–æ–∫–∞—á–∫–∞</button>
            <button class="nav-button" id="btnComputer">–ö—ñ–±–µ—Ä-–ú–æ–¥—É–ª—ñ</button>
            <button class="nav-button" id="btnMissions">–ó–∞–≤–¥–∞–Ω–Ω—è</button>
            <button class="nav-button" id="btnCards">–¢—Ä–æ—Ñ–µ—ó</button>
            <button class="nav-button" id="btnShop">–ú–∞–≥–∞–∑–∏–Ω</button>
            <button class="nav-button" id="btnBoosts">–ü—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ</button>
            <button class="nav-button" id="btnClan">–ë—Ä–∏–≥–∞–¥–∏</button>
            <button class="nav-button" id="btnStats">–ó–≤—ñ—Ç</button>
            <button class="nav-button" id="btnPreSale">TON Exchange</button>
        </div>
    </div>

    <div id="introModal" class="modal" style="display: flex;">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('introModal')">&times;</span>
            <h2>üá∫üá¶ –ö–æ–¥–µ–∫—Å –ö—ñ–±–æ—Ä–≥–∞</h2>
            <p style="margin-bottom: 20px; text-align: justify; line-height: 1.6;">
                –ù–∞—à —Å–≤—ñ—Ç –∑—Ä—É–π–Ω–æ–≤–∞–Ω–∏–π, –∞–ª–µ **–ù–µ—Å–∫–æ—Ä–µ–Ω–∏–π**. –ó 2014 —Ä–æ–∫—É —ñ –æ—Å–æ–±–ª–∏–≤–æ –ø—ñ—Å–ª—è 24.02.2022, –º–∏ ‚Äî **–ö—ñ–±–æ—Ä–≥–∏**, –æ–±–æ—Ä–æ–Ω—è—î–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π –ë–∞—Å—Ç—ñ–æ–Ω. –ö–æ–∂–µ–Ω –≤–∞—à —Ç–∞–ø ‚Äî —Ü–µ **—Ä–µ—Å—É—Ä—Å**, –∫–æ–∂–Ω–µ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è ‚Äî **—Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è**, –∫–æ–∂–µ–Ω –∑—ñ–±—Ä–∞–Ω–∏–π UCBG ‚Äî **–∫—Ä–æ–∫ –¥–æ –ü–µ—Ä–µ–º–æ–≥–∏**.
            </p>
            <p style="margin-bottom: 20px; text-align: justify; line-height: 1.6; font-weight: bold;">
                –ù–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è: –∑—ñ–±—Ä–∞—Ç–∏ 200 –º–ª–Ω UCBG, —â–æ–± –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ **"–ï—Ñ–µ–∫—Ç –Ø–π—Ü—è"** —ñ –ø—Ä–∏–ø–∏–Ω–∏—Ç–∏ –º–∞–Ω—ñ–Ω–≥ –Ω–∞–∑–∞–≤–∂–¥–∏, –∑–∞—Ñ—ñ–∫—Å—É–≤–∞–≤—à–∏ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å –º–æ–Ω–µ—Ç–∏.
            </p>
            <p style="margin-top: 30px; font-size: 0.9em; color: #808080; text-align: center;">
                –°–ª–∞–≤–∞ –£–∫—Ä–∞—ó–Ω—ñ! –ì–µ—Ä–æ—è–º –°–ª–∞–≤–∞!
            </p>
            <button class="buy-button" onclick="startGameAfterIntro()">–ü—Ä–∏—Å—Ç—É–ø–∏—Ç–∏ –¥–æ –û–ø–µ—Ä–∞—Ü—ñ—ó</button>
        </div>
    </div>

    <div id="upgradesModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('upgradesModal')">&times;</span>
            <h2>üõ†Ô∏è –ü—Ä–æ–∫–∞—á–∫–∞ (–û–∑–±—Ä–æ—î–Ω–Ω—è)</h2>
            <div id="upgradesList"></div>
        </div>
    </div>
    
    <div id="computerModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('computerModal')">&times;</span>
            <h2>üíª –ö—ñ–±–µ—Ä-–ú–æ–¥—É–ª—ñ (PC)</h2>
            <p style="text-align: center; margin-bottom: 20px;">
                –ü–æ—Å–∏–ª—é–π—Ç–µ –ö—ñ–±–µ—Ä-—è–¥—Ä–æ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –≤—ñ–¥–¥–∞—á—ñ!
            </p>
            <div id="computerPartsList"></div>
        </div>
    </div>

    <div id="missionsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('missionsModal')">&times;</span>
            <h2>üéØ –ó–∞–≤–¥–∞–Ω–Ω—è (–ë–æ–π–æ–≤–∏–π –ø–ª–∞–Ω)</h2>
            <div id="missionsList"></div>
        </div>
    </div>

    <div id="cardsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('cardsModal')">&times;</span>
            <h2>üèÜ –¢—Ä–æ—Ñ–µ—ó</h2>
            <p style="text-align: center;">–ù–∞—Å—Ç—É–ø–Ω–∏–π –∑–±—ñ—Ä —Ç—Ä–æ—Ñ–µ—ó–≤: <span id="cardsRefreshTimer">00:00:00</span></p>
            <div id="cardsList"></div>
        </div>
    </div>

    <div id="shopModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('shopModal')">&times;</span>
            <h2>üõí –ú–∞–≥–∞–∑–∏–Ω (–ï–∫—ñ–ø—ñ—Ä—É–≤–∞–Ω–Ω—è)</h2>
            <div class="shop-category">–û–±–º—ñ–Ω –Ω–∞ NFT —Ç–∞ TON (–Ü–º—ñ—Ç–∞—Ü—ñ—è)</div>
            <div class="store-item">
                <div class="shop-item-details">
                    <h3>–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è UCBG –≤ NFT</h3>
                    <p>–ö–æ–ª–µ–∫—Ü—ñ–æ–Ω—É–π—Ç–µ UCBG –¥–ª—è –æ–±–º—ñ–Ω—É –Ω–∞ NFT-–∫–æ–ª–µ–∫—Ü—ñ—é –ö—ñ–±–æ—Ä–≥—ñ–≤.</p>
                </div>
                <div class="shop-item-actions">
                    <button class="buy-button" onclick="showToast('–§—É–Ω–∫—Ü—ñ—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ. –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –∞–Ω–æ–Ω—Å–∞–º–∏!', 'info')">–ö–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏</button>
                </div>
            </div>

            <div class="shop-category">–ü—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –ú–∞–Ω—ñ–Ω–≥—É</div>
            <div class="store-item">
                <div class="shop-item-details">
                    <h3>üöÄ –ü—Ä–µ–º—ñ—É–º –ü—ñ–¥–ø–∏—Å–∫–∞ (x5 –î–æ—Ö—ñ–¥)</h3>
                    <p>–ü—ñ–¥–≤–∏—â—É—î –∑–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ x5 –Ω–∞–∑–∞–≤–∂–¥–∏. –í–∞–ª—é—Ç–∞: TON</p>
                </div>
                <div class="shop-item-actions">
                    <button class="buy-button" onclick="buySubscription(5)">–ö—É–ø–∏—Ç–∏ (5 TON)</button>
                </div>
            </div>

            <div class="shop-category">–°–∫–∏–Ω–∏ –ö—ñ–±–æ—Ä–≥–∞</div>
            <div class="current-skin-preview" id="currentSkinPreview"></div>
            <div id="skinsList"></div>
        </div>
    </div>

    <div id="boostsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('boostsModal')">&times;</span>
            <h2>‚ö° –ü—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ (–ë–∞—Ñ—Ñ–∏)</h2>
            <div class="shop-category">–ê–∫—Ç–∏–≤–Ω—ñ</div>
            <div id="activeBoostsList">
                <p style="text-align: center;">–ê–∫—Ç–∏–≤–Ω–∏—Ö –ø—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ–≤ –Ω–µ–º–∞—î.</p>
            </div>
            <div class="shop-category">–ú–∞–≥–∞–∑–∏–Ω</div>
            <div id="boostsShopList"></div>
        </div>
    </div>

    <div id="clanModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('clanModal')">&times;</span>
            <h2>ü§ù –ë—Ä–∏–≥–∞–¥–∏ (–ö–ª–∞–Ω–∏)</h2>
            <div class="clan-info">
                <h3>–í–∞—à –ü—Ä–æ—Ñ—ñ–ª—å</h3>
                <p>–ü–æ–∑–∏–≤–Ω–∏–π: <span id="playerNicknameElem" class="stat-value">–ê–Ω–æ–Ω—ñ–º</span></p>
                <p>ID: <span id="playerIDElem" class="stat-value"></span></p>
            </div>
            <div class="clan-info">
                <h3>–í–∞—à–∞ –ë—Ä–∏–≥–∞–¥–∞</h3>
                <p>–ù–∞–∑–≤–∞: <span id="myClanNameElem" class="stat-value">–ù–µ –≤ –ë—Ä–∏–≥–∞–¥—ñ</span></p>
                <p>–†–∞–Ω–≥: <span id="myClanRankElem" class="stat-value"></span></p>
                <p>–ö—ñ–±–æ—Ä–≥—ñ–≤: <span id="myClanMembersElem" class="stat-value"></span></p>
                <p>–ó–∞–≥–∞–ª—å–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å: <span id="myClanTotalProgressElem" class="stat-value"></span></p>
            </div>
            <div class="clan-input-group">
                <input type="text" id="clanNameInput" placeholder="–ù–∞–∑–≤–∞ –ë—Ä–∏–≥–∞–¥–∏/–ö–æ–¥">
                <button class="buy-button" onclick="joinOrCreateClan()">–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—å/–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ë—Ä–∏–≥–∞–¥—É</button>
            </div>
        </div>
    </div>

    <div id="statsModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('statsModal')">&times;</span>
            <h2>üìä –ó–≤—ñ—Ç –ø—Ä–æ –û–ø–µ—Ä–∞—Ü—ñ—é</h2>
            <div class="stats-info">
                <h3>–í–∞—à—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏</h3>
                <p>–í—Å—å–æ–≥–æ UCBG: <span class="stat-value" id="ucbgCountStat">0</span></p>
                <p>–í—Å—å–æ–≥–æ TON: <span class="stat-value" id="tonCountStat">0</span></p>
                <p>–ü–æ—Ç–æ—á–Ω–∞ –ú–æ—â–Ω—ñ—Å—Ç—å (–∫–ª—ñ–∫): <span class="stat-value" id="clickPowerStat">1</span></p>
                <p>–ü–æ—Ç–æ—á–Ω–∏–π –ê–≤—Ç–æ-–¥–æ—Ö—ñ–¥: <span class="stat-value" id="autoClickPowerDisplayStat">0</span></p>
                <p>–ï–º—ñ—Å—ñ—è (–í–∞—à–∞): <span class="stat-value" id="worldProgressTextStat">0%</span></p>
            </div>
            <div class="stats-info">
                <h3>–ì–ª–æ–±–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏</h3>
                <p>–ö—ñ–±–æ—Ä–≥—ñ–≤ –û–Ω–ª–∞–π–Ω: <span class="stat-value" id="globalOnlinePlayers">N/A</span></p>
                <p>–í—Å—å–æ–≥–æ UCBG –Ω–∞–º–∞–π–Ω–µ–Ω–æ: <span class="stat-value" id="globalTotalGptcMined">N/A</span></p>
                <p>–í–∞—à –≥–ª–æ–±–∞–ª—å–Ω–∏–π —Ä–∞–Ω–≥: <span class="stat-value" id="globalPlayerRank">N/A</span></p>
            </div>
        </div>
    </div>

    <div id="presaleModal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('presaleModal')">&times;</span>
            <h2>üí∏ TON Exchange (–¢—Ä–µ–π–¥)</h2>
            <div class="presale-info">
                <p>–û–±–º—ñ–Ω—è–π—Ç–µ TON –Ω–∞ UCBG –¥–ª—è —à–≤–∏–¥–∫–æ—ó –ø—Ä–æ–∫–∞—á–∫–∏!</p>
                <p>–í–∞—à—ñ TON: <span id="presaleTonCount" class="stat-value">0</span></p>
                <p>–ö—É—Ä—Å: 1 TON = 100,000 UCBG</p>
                <label for="presaleTonInput">–°–∫—ñ–ª—å–∫–∏ TON –±–∞–∂–∞—î—Ç–µ –æ–±–º—ñ–Ω—è—Ç–∏?</label>
                <input type="number" id="presaleTonInput" class="presale-buy-input" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å TON" min="0.01" step="0.01">
                <button class="buy-button" onclick="buyPreSaleTokens()">–û–±–º—ñ–Ω—è—Ç–∏</button>
            </div>
        </div>
    </div>


    <script>
        // --- Game State Variables ---
        let ucbg = 0;
        let ton = 0;
        let clickPower = 1;
        let autoClickPower = 0;
        let totalMinedUCBG = 0; // Total UCBG mined by the player
        const EMISSION_LIMIT = 200000000; // 200 Million UCBG, where mining stops

        const BASE_CLICK_POWER = 1;
        const BASE_AUTO_CLICK_POWER = 0;
        const BASE_WORLD_PROGRESS_PER_CLICK = 1; // 1 UCBG per click base

        let upgrades = {};
        let computerParts = {};
        let missions = {};
        let collectedCards = {};
        let currentAvailableCards = [];
        let cardsRefreshTime = 0;
        let ownedSkins = { 'default': true };
        let activeSkin = 'default';
        let activeBoosts = {};
        let introShown = localStorage.getItem('introShown') === 'true';

        // Custom Variables for UCBG
        let isPremium = localStorage.getItem('isPremium') === 'true';
        const PREMIUM_MULTIPLIER = 5;
        let currentLanguage = localStorage.getItem('currentLanguage') || 'ua';


        // Clan data
        let playerNickname = localStorage.getItem('playerNickname') || '–ö—ñ–±–æ—Ä–≥-–ù—ñ–∫';
        let playerID = localStorage.getItem('playerID') || generateUniqueId();
        let myClan = localStorage.getItem('myClan') || '';
        let myClanRank = localStorage.getItem('myClanRank') || 'N/A';
        let myClanMembers = localStorage.getItem('myClanMembers') || 'N/A';
        let myClanTotalProgress = localStorage.getItem('myClanTotalProgress') || 'N/A';

        // --- DOM Elements ---
        const ucbgCountElem = document.getElementById('ucbgCount');
        const tonCountElem = document.getElementById('tonCount');
        const clickPowerElem = document.getElementById('clickPower');
        const autoClickPowerDisplayElem = document.getElementById('autoClickPowerDisplay');
        const worldProgressFill = document.getElementById('worldProgressFill');
        const worldProgressText = document.getElementById('worldProgressText');
        const mainButton = document.getElementById('mainButton');
        const gameContainer = document.getElementById('gameContainer');
        const introModal = document.getElementById('introModal');
        const upgradesList = document.getElementById('upgradesList');
        const computerPartsList = document.getElementById('computerPartsList');
        const missionsList = document.getElementById('missionsList');
        const cardsList = document.getElementById('cardsList');
        const skinsList = document.getElementById('skinsList');
        const boostsShopList = document.getElementById('boostsShopList');
        const activeBoostsList = document.getElementById('activeBoostsList');

        const toastNotification = document.createElement('div');
        toastNotification.classList.add('toast-notification');
        document.body.appendChild(toastNotification);

        // Pre-sale elements
        const presaleTonInput = document.getElementById('presaleTonInput');
        const presaleTonCountElem = document.getElementById('presaleTonCount');

        // Stats elements
        const ucbgCountStat = document.getElementById('ucbgCountStat');
        const tonCountStat = document.getElementById('tonCountStat');
        const clickPowerStat = document.getElementById('clickPowerStat');
        const autoClickPowerDisplayStat = document.getElementById('autoClickPowerDisplayStat');
        const worldProgressTextStat = document.getElementById('worldProgressTextStat');
        const cardsRefreshTimerElem = document.getElementById('cardsRefreshTimer');

        // --- Translations ---
        const translations = {
            'ua': {
                'home': '–ì–æ–ª–æ–≤–Ω–∞', 'upgrades': '–ü—Ä–æ–∫–∞—á–∫–∞', 'computer': '–ö—ñ–±–µ—Ä-–ú–æ–¥—É–ª—ñ', 'missions': '–ó–∞–≤–¥–∞–Ω–Ω—è', 'cards': '–¢—Ä–æ—Ñ–µ—ó',
                'shop': '–ú–∞–≥–∞–∑–∏–Ω', 'boosts': '–ü—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á—ñ', 'clan': '–ë—Ä–∏–≥–∞–¥–∏', 'stats': '–ó–≤—ñ—Ç', 'presale': 'TON Exchange',
                'ucbg': 'UCBG', 'ton': 'TON', 'click_power': '–ú–æ—â–Ω—ñ—Å—Ç—å (–ö–ª—ñ–∫)', 'auto_income': '–ê–≤—Ç–æ-–¥–æ—Ö—ñ–¥', 'emission': '–ï–º—ñ—Å—ñ—è UCBG',
                'max_level': '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –¥–æ—Å—è–≥–Ω—É—Ç–æ!', 'buy': '–ö—É–ø–∏—Ç–∏', 'not_enough_resources': '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ä–µ—Å—É—Ä—Å—ñ–≤!',
                'click_boost': '–ë—É—Å—Ç –¥–æ –∫–ª—ñ–∫—É', 'auto_boost': '–ë—É—Å—Ç –¥–æ –∞–≤—Ç–æ-–¥–æ—Ö–æ–¥—É', 'mission_completed': '–í–∏–∫–æ–Ω–∞–Ω–æ!', 
                'claim_reward': '–ó–∞–±—Ä–∞—Ç–∏ –Ω–∞–≥–æ—Ä–æ–¥—É', 'buy_sub': '–ö—É–ø–∏—Ç–∏ (5 TON)', 'active': '–ê–∫—Ç–∏–≤–Ω–æ', 'apply': '–ü—Ä–∏–º—ñ–Ω–∏—Ç–∏',
                'join_clan': '–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—å/–°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ë—Ä–∏–≥–∞–¥—É', 'not_in_clan': '–ù–µ –≤ –ë—Ä–∏–≥–∞–¥—ñ', 'nickname': '–ü–æ–∑–∏–≤–Ω–∏–π',
                'exchange': '–û–±–º—ñ–Ω—è—Ç–∏', 'invalid_ton': '–í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å TON!', 'subscription_purchased': '–ü—Ä–µ–º—ñ—É–º –ü—ñ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞!',
                'mission_success': '–ú—ñ—Å—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–∞!', 'secret_code_activated': '–°–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–æ–¥ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ!', 'wrong_code': '–ù–µ–≤—ñ—Ä–Ω–∏–π —Å–µ–∫—Ä–µ—Ç–Ω–∏–π –∫–æ–¥!',
                'chest_not_enough_ucbg': '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ UCBG –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Å—É–Ω–¥—É–∫–∞!', 'chest_ucbg_reward': '–í–∏ –∑–Ω–∞–π—à–ª–∏ {amount} UCBG!',
                'chest_ton_reward': '–í–∏ –∑–Ω–∞–π—à–ª–∏ {amount} TON!', 'chest_card_reward': '–í–∏ –∑–Ω–∞–π—à–ª–∏ –Ω–æ–≤—É –∫–∞—Ä—Ç—É!', 'chest_opened': '–°—É–Ω–¥—É–∫ –≤—ñ–¥–∫—Ä–∏—Ç–æ!',
                'card_bought': '–ö–∞—Ä—Ç–∞ –∫—É–ø–ª–µ–Ω–∞!', 'upgrade_bought': '–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –∫—É–ø–ª–µ–Ω–æ!', 'part_bought': '–ö—ñ–±–µ—Ä-–ú–æ–¥—É–ª—å –∫—É–ø–ª–µ–Ω–∏–π!',
                'boost_bought': '–ü—Ä–∏—Å–∫–æ—Ä—é–≤–∞—á –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π –Ω–∞ {duration} –≥–æ–¥.!', 'skin_bought': '–í–∏ –∫—É–ø–∏–ª–∏ —Å–∫–∏–Ω "{name}"!', 
                'skin_applied': '–°–∫–∏–Ω "{name}" –ø—Ä–∏–º—ñ–Ω–µ–Ω–∏–π!', 'skin_not_owned': '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ UCBG –∞–±–æ —Å–∫–∏–Ω –≤–∂–µ –∫—É–ø–ª–µ–Ω–∏–π!',
                'clan_name_short': '–ù–∞–∑–≤–∞ –ë—Ä–∏–≥–∞–¥–∏ –º–∞—î –±—É—Ç–∏ –Ω–µ –º–µ–Ω—à–µ 3 —Å–∏–º–≤–æ–ª—ñ–≤!', 'already_in_clan': '–í–∏ –≤–∂–µ –≤ –ë—Ä–∏–≥–∞–¥—ñ "{name}"!',
                'join_success': '–í–∏ –ø—Ä–∏—î–¥–Ω–∞–ª–∏—Å—å –¥–æ –ë—Ä–∏–≥–∞–¥–∏ "{name}"!', 'update_nickname': '–í–∞—à –ø–æ–∑–∏–≤–Ω–∏–π —Ç–µ–ø–µ—Ä {nickname}.',
                'max_level_upgrade': '–¶–µ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –≤–∂–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ!', 'max_level_part': '–¶–µ–π –º–æ–¥—É–ª—å –ü–ö –≤–∂–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ!',
                'max_level_card': '–¶—è –∫–∞—Ä—Ç–∞ –≤–∂–µ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Ä—ñ–≤–Ω—ñ!', 'new_cards_available': '–î–æ—Å—Ç—É–ø–Ω—ñ –Ω–æ–≤—ñ —Ç—Ä–æ—Ñ–µ—ó!',
                'refresh_timer': '–ù–∞—Å—Ç—É–ø–Ω–∏–π –∑–±—ñ—Ä —Ç—Ä–æ—Ñ–µ—ó–≤: ', 'all_cards_collected': '–í—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —Ç—Ä–æ—Ñ–µ—ó –∑—ñ–±—Ä–∞–Ω—ñ! –î–æ—á–µ–∫–∞–π—Ç–µ—Å—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.',
                'not_enough_ton': '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ TON!'
            },
            'en': { /* ... (–ê–Ω–≥–ª—ñ–π—Å—å–∫–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥) ... */ },
            'ru': { /* ... (–†–æ—Å—ñ–π—Å—å–∫–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥) ... */ }
        };

        function getText(key) {
            return translations[currentLanguage][key] || key;
        }

        // --- Game Data (Simplified to UC/TON) ---
        const ALL_UPGRADES = [
            { id: 'arm_1', name: '–ü–æ—Å–∏–ª–µ–Ω–Ω—è –µ–∫–∑–æ—Å–∫–µ–ª–µ—Ç–∞', description: '–ó–±—ñ–ª—å—à—É—î –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ –∫–ª—ñ–∫—É.', maxLevel: 10,
              baseCost: { ucbg: 10 }, costMultiplier: 1.5, basePowerBoost: 1, powerBoostMultiplier: 1.2 },
            { id: 'arm_2', name: '–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ö—ñ–±–µ—Ä-–Ø–¥—Ä–∞', description: '–ó–Ω–∞—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–ª—ñ–∫—ñ–≤.', maxLevel: 5,
              baseCost: { ucbg: 100, ton: 0.1 }, costMultiplier: 1.8, basePowerBoost: 5, powerBoostMultiplier: 1.5 },
            { id: 'auto_1', name: '–ó–∞–ø—É—Å–∫ –î—Ä–æ–Ω–∞-–†–µ–º–æ–Ω—Ç–Ω–∏–∫–∞', description: '–ü–æ—á–∏–Ω–∞—î –ø–∞—Å–∏–≤–Ω–∏–π –∑–±—ñ—Ä UCBG.', maxLevel: 15,
              baseCost: { ucbg: 50 }, costMultiplier: 1.4, baseAutoBoost: 1, autoBoostMultiplier: 1.2 },
            { id: 'auto_2', name: '–ê–≤—Ç–æ–Ω–æ–º–Ω–∏–π –ú–∞–π–Ω—ñ–Ω–≥ –ú–æ–¥—É–ª—å', description: '–ó–±—ñ–ª—å—à—É—î —à–≤–∏–¥–∫—ñ—Å—Ç—å –ø–∞—Å–∏–≤–Ω–æ–≥–æ –∑–±–æ—Ä—É.', maxLevel: 10,
              baseCost: { ucbg: 500, ton: 0.5 }, costMultiplier: 1.7, baseAutoBoost: 5, autoBoostMultiplier: 1.4 },
        ];

        const ALL_COMPUTER_PARTS = [
            { id: 'cpu', name: '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∏–π –ü—Ä–æ—Ü–µ—Å–æ—Ä', description: '–ó–±—ñ–ª—å—à—É—î –∑–∞–≥–∞–ª—å–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, —Å–∏–ª—É –∫–ª—ñ–∫—É.', maxLevel: 10,
              baseCost: { ucbg: 1000, ton: 1 }, costMultiplier: 2.0, basePowerBoost: 10, powerBoostMultiplier: 1.3 },
            { id: 'gpu', name: '–ù–µ–π—Ä–æ-–í—ñ–¥–µ–æ–∫–∞—Ä—Ç–∞ (FPV-–º–æ–¥—É–ª—å)', description: '–û–ø—Ç–∏–º—ñ–∑—É—î –æ–±—Ä–æ–±–∫—É, –∑–±—ñ–ª—å—à—É—î –∞–≤—Ç–æ-–¥–æ—Ö—ñ–¥.', maxLevel: 10,
              baseCost: { ucbg: 1500, ton: 1.5 }, costMultiplier: 2.1, baseAutoBoost: 10, autoBoostMultiplier: 1.35 },
            { id: 'ram', name: '–ö–≤–∞–Ω—Ç–æ–≤–∞ –û–ó–£', description: '–ó–±—ñ–ª—å—à—É—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –≤—Å—ñ—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π.', maxLevel: 5,
              baseCost: { ucbg: 2000, ton: 2.5 }, costMultiplier: 2.5, basePowerBoost: 5, powerBoostMultiplier: 1.1, baseAutoBoost: 5, autoBoostMultiplier: 1.1 },
        ];

        const ALL_MISSIONS = [
            { id: 'click_100', name: '–ü—Ä–æ–≤–µ—Å—Ç–∏ 100 –¢–∞–ø—ñ–≤', target: 100, current: 0, reward: { ucbg: 500 }, type: 'click', completed: false },
            { id: 'buy_1_upgrade', name: '–ü—Ä–∏–¥–±–∞—Ç–∏ 1 –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è', target: 1, current: 0, reward: { ucbg: 1000 }, type: 'upgrade_bought', completed: false },
            { id: 'telegram_channel', name: '–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å –Ω–∞ @Ukrainian_Cyborgs', target: 1, current: 0, reward: { ucbg: 10000 }, type: 'channel_sub', completed: false, link: 'https://t.me/Ukrainian_Cyborgs' },
            { id: 'telegram_chat', name: '–ü—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—å –Ω–∞ @Ukrainian_Cyborgs_ton', target: 1, current: 0, reward: { ucbg: 10000 }, type: 'channel_sub', completed: false, link: 'https://t.me/Ukrainian_Cyborgs_ton' },
            { id: 'invite_1_friend', name: '–ó–∞–ø—Ä–æ—Å–∏—Ç–∏ 1 –î—Ä—É–≥–∞ (–ü–æ—á–∞—Ç–∫–æ–≤–∏–π)', target: 1, current: 0, reward: { ucbg: 5000 }, type: 'invite', completed: false },
            { id: 'invite_5_friends', name: '–ó–∞–ø—Ä–æ—Å–∏—Ç–∏ 5 –î—Ä—É–∑—ñ–≤', target: 5, current: 0, reward: { ucbg: 15000, ton: 0.05 }, type: 'invite', completed: false },
            { id: 'ucbg_5000', name: '–ù–∞–∫–æ–ø–∏—á–∏—Ç–∏ 5,000 UCBG', target: 5000, current: 0, reward: { ucbg: 3000 }, type: 'ucbg_reach', completed: false },
            { id: 'buy_1_card', name: '–ó–¥–æ–±—É—Ç–∏ 1 –¢—Ä–æ—Ñ–µ–π', target: 1, current: 0, reward: { ucbg: 2000 }, type: 'card_bought', completed: false },
            { id: 'buy_1_computer_part', name: '–ü—Ä–∏–¥–±–∞—Ç–∏ 1 –ö—ñ–±–µ—Ä-–ú–æ–¥—É–ª—å', target: 1, current: 0, reward: { ucbg: 7500, ton: 0.1 }, type: 'computer_part_bought', completed: false },
        ];
        
        // ... (ALL_CARDS, ALL_SKINS, ALL_BOOSTS –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è —ñ—Å–Ω—É—é—á–∏–º–∏, –∞–ª–µ –∑ –∑–∞–º—ñ–Ω–æ—é UCBG –∑–∞–º—ñ—Å—Ç—å GPTC/AICU) ...

        // --- Helper Functions ---
        function formatNumber(num) {
            if (num === undefined || num === null) return 'N/A';
            if (num >= 1_000_000_000_000) return (num / 1_000_000_000_000).toFixed(2) + 'T';
            if (num >= 1_000_000_000) return (num / 1_000_000_000).toFixed(2) + 'B';
            if (num >= 1_000_000) return (num / 1_000_000).toFixed(2) + 'M';
            if (num >= 1_000) return (num / 1_000).toFixed(2) + 'K';
            return Math.round(num * 100) / 100;
        }

        function showToast(message, type = 'info') { /* ... (Toast logic) ... */ }
        function generateUniqueId() { /* ... (ID logic) ... */ return 'player_' + Math.random().toString(36).substr(2, 9); }

        function getCostHtml(costs) {
            let html = '';
            for (const currency in costs) {
                if (costs[currency] > 0) {
                    let currencyClass = currency === 'ton' ? 'ton' : 'ucbg';
                    html += `<span class="cost-item"><span class="icon ${currencyClass}"></span> ${formatNumber(costs[currency])}</span>`;
                }
            }
            return html;
        }

        function canAfford(costs) {
            for (const currency in costs) {
                if (currency === 'ucbg' && ucbg < costs[currency]) return false;
                if (currency === 'ton' && ton < costs[currency]) return false;
            }
            return true;
        }

        function deductCost(costs) {
            for (const currency in costs) {
                if (currency === 'ucbg') ucbg -= costs[currency];
                if (currency === 'ton') ton -= costs[currency];
            }
        }
        
        function getBoostMultiplier(type) { /* ... (Boost logic) ... */ return 1; }

        // --- Game State Management ---
        function saveGame() {
            // –£ —Ä–µ–∞–ª—å–Ω—ñ–π –≥—Ä—ñ: Telegram.WebApp.ready(); Telegram.WebApp.request.set.data(JSON.stringify(state));
            localStorage.setItem('ucbg', ucbg.toFixed(2));
            localStorage.setItem('ton', ton.toFixed(2));
            localStorage.setItem('totalMinedUCBG', totalMinedUCBG.toFixed(2));
            // ... save other variables
            localStorage.setItem('isPremium', isPremium);
            localStorage.setItem('currentLanguage', currentLanguage);
        }

        function loadGame() {
            // –£ —Ä–µ–∞–ª—å–Ω—ñ–π –≥—Ä—ñ: Telegram.WebApp.ready(); const data = Telegram.WebApp.request.get.data();
            ucbg = parseFloat(localStorage.getItem('ucbg')) || 0;
            ton = parseFloat(localStorage.getItem('ton')) || 0;
            totalMinedUCBG = parseFloat(localStorage.getItem('totalMinedUCBG')) || 0;
            // ... load other variables
            isPremium = localStorage.getItem('isPremium') === 'true';
            currentLanguage = localStorage.getItem('currentLanguage') || 'ua';
            // Ensure introShown is boolean
            introShown = localStorage.getItem('introShown') === 'true';
        }

        function calculateStats() {
            let currentClickPower = BASE_CLICK_POWER;
            let currentAutoClickPower = BASE_AUTO_CLICK_POWER;

            // ... (Logic from ALL_UPGRADES, ALL_CARDS, ALL_COMPUTER_PARTS to calculate currentClickPower and currentAutoClickPower) ...

            let effectiveMultiplier = 1;
            if (isPremium) effectiveMultiplier *= PREMIUM_MULTIPLIER;
            effectiveMultiplier *= getBoostMultiplier('clickPower'); // Apply boosts (if implemented)

            clickPower = currentClickPower * effectiveMultiplier;
            autoClickPower = currentAutoClickPower * effectiveMultiplier;
        }

        function updateDisplay() {
            calculateStats();
            
            ucbgCountElem.textContent = formatNumber(ucbg);
            tonCountElem.textContent = formatNumber(ton);
            clickPowerElem.textContent = formatNumber(clickPower);
            autoClickPowerDisplayElem.textContent = formatNumber(autoClickPower);
            
            const emissionPercent = (totalMinedUCBG / EMISSION_LIMIT * 100);
            worldProgressFill.style.width = `${Math.min(100, emissionPercent)}%`;
            worldProgressText.textContent = `${emissionPercent.toFixed(6)}%`; // High precision for emission

            // Update stats modal
            // ... (similar updates for stats modal elements) ...
        }

        // --- Navigation ---
        function setupNavigation() { /* ... (Navigation logic) ... */ }
        function closeModal(modalId) { /* ... (Close modal logic) ... */ }

        // --- Main Button Logic (Tap) ---
        mainButton.addEventListener('click', (event) => {
            if (totalMinedUCBG >= EMISSION_LIMIT) {
                showToast('–ï–º—ñ—Å—ñ—è UCBG –ø—Ä–∏–ø–∏–Ω–µ–Ω–∞! –§—É–Ω–∫—Ü—ñ—è "–ï—Ñ–µ–∫—Ç –Ø–π—Ü—è" –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞.', 'error');
                return;
            }

            const earnedUCBG = clickPower;
            ucbg += earnedUCBG;
            totalMinedUCBG += earnedUCBG;

            updateMissionProgress('click_100', 1);
            
            mainButton.classList.add('clicked');
            setTimeout(() => { mainButton.classList.remove('clicked'); }, 100);

            const floatingText = document.createElement('div');
            floatingText.classList.add('floating-text');
            floatingText.textContent = `+${formatNumber(earnedUCBG)}`;
            
            floatingText.style.left = `${event.clientX}px`;
            floatingText.style.top = `${event.clientY}px`;
            
            document.body.appendChild(floatingText);
            floatingText.addEventListener('animationend', () => { floatingText.remove(); });
            
            updateDisplay();
            saveGame();
        });

        // --- Auto Clicker ---
        function startAutoClicker() {
            setInterval(() => {
                if (totalMinedUCBG >= EMISSION_LIMIT) return;

                const earnedUCBG = autoClickPower;
                if (earnedUCBG > 0) {
                    ucbg += earnedUCBG;
                    totalMinedUCBG += earnedUCBG;
                    updateDisplay();
                    saveGame();
                }
            }, 1000); // Every second
        }

        // --- Missions Logic ---
        function updateMissionProgress(missionId, value) {
            const mission = missions[missionId];
            if (!mission || mission.completed) return;
            // ... (Mission progress logic) ...
            saveGame();
            // renderMissions(); // Should be called after successful claim
        }

        function claimMissionReward(id) {
             // ... (Claim reward logic) ...
             // For telegram_channel/chat: check if user is a member (requires real Telegram API, here we just assume success)
            if (mission.type === 'channel_sub') {
                // Real check with Telegram API needed here
                mission.completed = true;
            }
             // ... (Rest of claim logic) ...
        }

        // --- Subscription Logic ---
        function buySubscription(price) {
            const SUB_TON_COST = price;
            if (ton < SUB_TON_COST) {
                showToast(getText('not_enough_ton'), 'error');
                return;
            }
            
            // –£ —Ä–µ–∞–ª—å–Ω—ñ–π –≥—Ä—ñ: Telegram.WebApp.openInvoice('invoice_url');
            ton -= SUB_TON_COST;
            isPremium = true;
            showToast(getText('subscription_purchased'), 'success');
            
            updateDisplay();
            saveGame();
        }

        // --- TON Exchange Logic ---
        function buyPreSaleTokens() {
            const tonAmount = parseFloat(presaleTonInput.value);
            const EXCHANGE_RATE = 100000; // 1 TON = 100,000 UCBG

            if (isNaN(tonAmount) || tonAmount <= 0) {
                showToast(getText('invalid_ton'), 'error');
                return;
            }
            if (ton < tonAmount) {
                showToast(getText('not_enough_ton'), 'error');
                return;
            }
            if (totalMinedUCBG >= EMISSION_LIMIT) {
                showToast('–ï–º—ñ—Å—ñ—è UCBG –ø—Ä–∏–ø–∏–Ω–µ–Ω–∞. –û–±–º—ñ–Ω –Ω–µ–º–æ–∂–ª–∏–≤–∏–π.', 'error');
                return;
            }

            ton -= tonAmount;
            const ucbgGained = tonAmount * EXCHANGE_RATE;
            ucbg += ucbgGained;
            totalMinedUCBG += ucbgGained;

            showToast(`–£—Å–ø—ñ—à–Ω–æ! –í–∏ –æ–±–º—ñ–Ω—è–ª–∏ ${formatNumber(tonAmount)} TON –Ω–∞ ${formatNumber(ucbgGained)} UCBG!`);
            presaleTonInput.value = '';
            updateDisplay();
            saveGame();
        }

        // --- Language Selector ---
        function setupLanguageSelector() {
            document.querySelectorAll('.language-selector button').forEach(button => {
                button.addEventListener('click', () => {
                    const lang = button.id.replace('lang', '').toLowerCase();
                    currentLanguage = lang;
                    localStorage.setItem('currentLanguage', currentLanguage);
                    // Reload or re-render elements with new language
                    // For simplicity in this demo, you would need to implement a full re-render of all text content
                    showToast(`–ú–æ–≤–∞ –∑–º—ñ–Ω–µ–Ω–∞ –Ω–∞ ${lang.toUpperCase()}`, 'info');
                    document.querySelectorAll('.language-selector button').forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });
            document.getElementById(`lang${currentLanguage.toUpperCase()}`).classList.add('active');
        }

        // --- Initial Load ---
        function initGame() {
            loadGame();

            if (!introShown) {
                introModal.style.display = 'flex';
                gameContainer.style.display = 'none';
                return;
            }
            gameContainer.style.display = 'block';

            // ... (Mission and other initialization logic) ...

            calculateStats();
            // applyActiveSkin(); // Must be implemented
            updateDisplay();
            setupNavigation();
            startAutoClicker();
            // startCardsRefreshTimer(); // Must be implemented
            // startBoostsTimer(); // Must be implemented
            setupLanguageSelector();
            
            // Periodic check for missions
            setInterval(() => {
                updateMissionProgress('ucbg_5000', ucbg);
            }, 5000);
        }

        function startGameAfterIntro() {
            introShown = true;
            localStorage.setItem('introShown', 'true');
            closeModal('introModal');
            initGame();
        }

        document.addEventListener('DOMContentLoaded', initGame);

    </script>
</body>
</html>
